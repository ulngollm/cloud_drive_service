## Info

Демо-приложение для пакета [ully/cloudstorages](https://github.com/ulngollm/laravel-cloudstorages).

Демо использует REST API пакета и дополняет его аутентификацией c Bearer-токеном. Спецификация демо доступна [здесь](https://app.swaggerhub.com/apis/ulngollm/lms_disk_api/1.0.3).


## Как развернуть приложение
В ветке [infra](tree/infra) есть готовая Docker-конфигурация для приложения.

Чтобы ее использовать, необходимо создать следующую структуру директорий:
```bash
.
├── app
└── infra
```
где `app` - папка с приложением (ветка `master`),  
`infra` - папка с инфраструктурой (ветка `infra`).

Для сборки образов выполнить
```
make build
```

После этого контейнеры можно запускать командой `make up` или `make start`. API будет доступен на `http://localhost:8001/api`. 

На `http://localhost:8001` доступна докуметация API со Swagger UI. API можно тестировать прямо отсюда.

### Запуск приложения
После сборки и первого `make up` необходимо зайти в контейнер `php` и выполнить следующие команды:
```bash
php artisan migrate
php artisan drivers:update
```
Выполнятся миграции и БД заполнится тестовыми данными. 

## Аутентификация
Как этим пользоваться?

Если вы заходите впервые, запрашиваете новый токен для доступа к сервису. Для этого есть эндпоинт `GET` `/user`. При этом создается новый временный пользователь. Аутентифицируетесь и можете создавать от этого аккаунта хранилища.

Токен - это единственный способ вас идентифицировать. Пока вы помните токен, у вас есть доступ к аккаунту. Если вы потеряли токен - API вас не знает.

Это удобно для демки. Вам не надо регистрироваться как пользователь, чтобы попробовать приложение. Достаточно сохранить токен.

Чтобы удалить свой демо-аккаунт, выполните `DELETE`-запрос на `/user`. Это удалит из БД временного пользователя и все его хранилища
